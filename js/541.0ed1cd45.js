(self["webpackChunkclouddrive"]=self["webpackChunkclouddrive"]||[]).push([[541],{2638:(e,t,i)=>{"use strict";i.d(t,{X:()=>l});i(702),i(4641),i(3269);var r=i(2502),s=i(1569),o=i(2881);const a=(0,o.O)(),l=(0,r.Q_)({id:"directory",state:()=>({form:{Name:"",ParentDirectoryId:null}}),actions:{async addDirectory(){await s.api.post("/File/addDirectory",this.form,{headers:{Authorization:`Bearer ${a.currentUser.token}`}})},clearForm(){this.form.Name="",this.form.ParentDirectoryId=null},getDirectoriesToSelectList(){if(a.currentUser&&a.currentUser.token)return new Promise((e=>{s.api.get("/File/getDirectoriesToSelectList",{headers:{Authorization:`Bearer ${a.currentUser.token}`}}).then((t=>{e(t.data)}))}))},getUserDriveDataToTreeView(){if(a.currentUser&&a.currentUser.token)return new Promise((e=>{s.api.get("/File/getUserDriveDataToTreeView",{headers:{Authorization:`Bearer ${a.currentUser.token}`}}).then((t=>{e(t.data)}))}))},async downloadDirectory({id:e,name:t}){a.currentUser&&a.currentUser.token&&await s.api.get("/File/downloadDirectory",{responseType:"blob",headers:{Authorization:`Bearer ${a.currentUser.token}`},params:{directoryId:e}}).then((e=>{const i=new Blob([e.data],{type:e.data.type}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download=t,r.click(),URL.revokeObjectURL(r.href)}))}}})},4487:(e,t,i)=>{"use strict";i.d(t,{Z:()=>f});var r=i(9835),s=i(6970);const o={class:"q-pa-xl main-cont"},a={class:"rounded-borders bg-primary text-white text-center shadow-10 q-pa-xl"},l={class:"row"},n={class:"text-h3 full-width text-center q-mt-xl"};function d(e,t,i,d,c,u){const m=(0,r.up)("q-separator");return(0,r.wg)(),(0,r.iD)("div",o,[(0,r._)("div",a,[(0,r._)("div",l,[(0,r._)("p",n,(0,s.zw)(i.title),1)]),(0,r.Wm)(m,{class:"q-mb-xl q-mt-sm"}),(0,r.WI)(e.$slots,"default",{},void 0,!0)])])}const c={name:"MainContainer",props:{title:{type:String,required:!1,default:""}}};var u=i(1639),m=i(926),p=i(9984),y=i.n(p);const h=(0,u.Z)(c,[["render",d],["__scopeId","data-v-78c84cd8"]]),f=h;y()(c,"components",{QSeparator:m.Z})},614:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>ve});var r=i(9835),s=i(1957);const o={class:"row"},a={class:"column q-mx-md"},l={class:"q-mt-md"};function n(e,t,i,n,d,c){const u=(0,r.up)("q-space"),m=(0,r.up)("q-btn"),p=(0,r.up)("directory-add-form"),y=(0,r.up)("files-grid"),h=(0,r.up)("main-container"),f=(0,r.up)("q-page");return(0,r.wg)(),(0,r.j4)(s.uT,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{class:"flex justify-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(h,{title:"Mój dysk"},{default:(0,r.w5)((()=>[(0,r._)("div",o,[(0,r.Wm)(u),(0,r._)("div",a,[(0,r.Wm)(m,{label:c.getButtonLabel(),icon:"fa-solid fa-folder-plus",color:"secondary",outline:d.isAddDirectoryMenuOpen,"text-color":c.getTextColor(),type:"submit",onClick:t[0]||(t[0]=()=>{d.isAddDirectoryMenuOpen=!d.isAddDirectoryMenuOpen})},null,8,["label","outline","text-color"])])]),(0,r.Wm)(s.uT,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:(0,r.w5)((()=>[d.isAddDirectoryMenuOpen?((0,r.wg)(),(0,r.j4)(p,{key:0,onClose:c.onDirectoryAddFormClose,class:"q-mt-md"},null,8,["onClose"])):(0,r.kq)("",!0)])),_:1}),(0,r._)("div",l,[(0,r.Wm)(y,{ref:"filesGrid"},null,512)])])),_:1})])),_:1})])),_:1})}var d=i(4487);const c=e=>((0,r.dD)("data-v-05bde909"),e=e(),(0,r.Cn)(),e),u={class:"section-container"},m=c((()=>(0,r._)("p",{class:"text-h5 q-mt-lg q-mb-xs"},"Dodawanie nowego folderu",-1))),p={class:"row q-py-lg"},y={class:"column q-mx-md form-field"},h={class:"column q-mx-md form-field"},f={class:"column q-mx-md"};function g(e,t,i,s,o,a){const l=(0,r.up)("q-input"),n=(0,r.up)("q-select"),d=(0,r.up)("q-space"),c=(0,r.up)("q-btn"),g=(0,r.up)("q-form");return(0,r.wg)(),(0,r.iD)("div",u,[m,(0,r.Wm)(g,{class:"q-gutter-md",onSubmit:a.tryAdd},{default:(0,r.w5)((()=>[(0,r._)("div",p,[(0,r._)("div",y,[(0,r.Wm)(l,{filled:"",modelValue:e.form.Name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.Name=t),label:"Nazwa folderu","lazy-rules":"",color:"secondary",dark:"",rules:[e=>e&&e.length>0||"Nazwa folderu jest wymagana!"],dense:""},null,8,["modelValue","rules"])]),(0,r._)("div",h,[(0,r.Wm)(n,{filled:"",modelValue:e.form.ParentDirectoryId,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.ParentDirectoryId=t),label:"Folder nadrzędny",color:"secondary",dark:"",options:o.directories,"option-label":"text","option-value":"value","emit-value":"","map-options":"",dense:"",clearable:""},null,8,["modelValue","options"])]),(0,r.Wm)(d),(0,r._)("div",f,[(0,r.Wm)(c,{label:"Dodaj","text-color":"secondary",outline:"",type:"submit"})])])])),_:1},8,["onSubmit"])])}var w=i(2638),b=i(2502);const D={name:"DirectoryAddForm",data(){return{directories:[]}},computed:{...(0,b.Ah)(w.X,["form"])},methods:{...(0,b.nv)(w.X,["clearForm","addDirectory","getDirectoriesToSelectList"]),async tryAdd(){await this.addDirectory(),this.$q.notify({type:"positive",message:"Folder został dodany pomyślnie!"}),this.$emit("close")}},mounted(){this.getDirectoriesToSelectList().then((e=>{this.directories=e}))},beforeUnmount(){this.clearForm()}};var k=i(1639),v=i(8326),V=i(6611),U=i(4055),q=i(136),F=i(9379),x=i(9984),_=i.n(x);const j=(0,k.Z)(D,[["render",g],["__scopeId","data-v-05bde909"]]),z=j;_()(D,"components",{QForm:v.Z,QInput:V.Z,QSelect:U.Z,QSpace:q.Z,QBtn:F.Z});var S=i(6970);const T=e=>((0,r.dD)("data-v-e309e670"),e=e(),(0,r.Cn)(),e),O={class:"section-container"},W={class:"row justify-start q-mt-lg q-mx-lg"},A={class:"col-3"},Z=T((()=>(0,r._)("div",{class:"col-6"},[(0,r._)("p",{class:"text-h5 q-mt-lg q-mb-xs"},"Pliki")],-1))),C={class:"q-pa-md text-white"},B={key:0,class:"text-body1"},I={key:1},L={class:"text-body1"},P={class:"text-body2"},Q={key:0,class:"row justify-center q-my-xl"},$={class:"column"},M={class:"column"},H={class:"column"},R={key:1,class:"row justify-center q-my-xl"},N={class:"column"};function G(e,t,i,s,o,a){const l=(0,r.up)("q-btn"),n=(0,r.up)("q-tree"),d=(0,r.up)("file-versions-dialog"),c=(0,r.up)("q-splitter");return(0,r.wg)(),(0,r.iD)("div",O,[(0,r._)("div",W,[(0,r._)("div",A,[(0,r.Wm)(l,{label:"Pobierz zaznaczone pliki",icon:"fa-solid fa-list-check",color:"primary","text-color":"white",type:"submit",disabled:0===o.ticked.length,onClick:a.tryDownloadTickedFiles},null,8,["disabled","onClick"])]),Z]),(0,r._)("div",C,[(0,r.Wm)(c,{modelValue:o.splitterModel,"onUpdate:modelValue":t[7]||(t[7]=e=>o.splitterModel=e)},{before:(0,r.w5)((()=>[(0,r.Wm)(n,{nodes:a.getUserDirectories,"node-key":"id",color:"secondary","label-key":"name",dark:"",ticked:o.ticked,"onUpdate:ticked":t[0]||(t[0]=e=>o.ticked=e),selected:o.selected,"onUpdate:selected":t[1]||(t[1]=e=>o.selected=e),ref:"directoriesTree","no-nodes-label":"Dysk jest pusty","no-results-label":"Dysk jest pusty","tick-strategy":"strict"},null,8,["nodes","ticked","selected"])])),after:(0,r.w5)((()=>[o.selected?((0,r.wg)(),(0,r.iD)("div",I,[(0,r._)("p",L,"Wybrano "+(0,S.zw)(a.getSelectedObject.name),1),(0,r._)("p",P," Jego ścieżka to "+(0,S.zw)(a.getSelectedObject.relativePath),1),a.getSelectedObject.isFile?((0,r.wg)(),(0,r.iD)("div",Q,[(0,r._)("div",$,[(0,r.Wm)(l,{icon:"fa-solid fa-download",color:"secondary","text-color":"black",label:"Pobierz",class:"q-mx-sm",onClick:t[2]||(t[2]=e=>a.tryDownload())})]),(0,r._)("div",M,[(0,r.Wm)(l,{icon:"fa-solid fa-trash",color:"secondary","text-color":"black",label:"Usun",class:"q-mx-sm",onClick:t[3]||(t[3]=e=>a.tryDelete())})]),(0,r._)("div",H,[(0,r.Wm)(l,{icon:"fa-solid fa-code-branch",color:"secondary","text-color":"black",label:"Wersje",class:"q-mx-sm",onClick:t[4]||(t[4]=e=>o.isVersionsDialogVisible=!0)})])])):(0,r.kq)("",!0),a.getSelectedObject.isFile?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",R,[(0,r._)("div",N,[(0,r.Wm)(l,{icon:"fa-solid fa-file-zipper",color:"secondary","text-color":"black",label:"Pobierz",class:"q-mx-sm",onClick:t[5]||(t[5]=e=>a.tryDownloadDirectory())})])])),a.getSelectedObject.isFile?((0,r.wg)(),(0,r.j4)(d,{key:2,isVersionsDialogVisible:o.isVersionsDialogVisible,fileId:a.getSelectedObject.id,onDialogHide:t[6]||(t[6]=e=>o.isVersionsDialogVisible=!1),onDialogHideSelected:a.onDialogHideSelected},null,8,["isVersionsDialogVisible","fileId","onDialogHideSelected"])):(0,r.kq)("",!0)])):((0,r.wg)(),(0,r.iD)("p",B,"Wybierz plik lub folder"))])),_:1},8,["modelValue"])])])}i(702),i(4641),i(3269);var X=i(1569),E=i(2881);const J=(0,E.O)(),K=(0,b.Q_)({id:"file",state:()=>({}),actions:{getUserFiles(){return new Promise((e=>{X.api.get("/File/getUserFiles",{headers:{Authorization:`Bearer ${J.currentUser.token}`}}).then((t=>{this.files=t.data,e(t.data)}))}))},async deleteFile(e){J.currentUser&&J.currentUser.token&&await X.api["delete"]("/File/deleteFile",{headers:{Authorization:`Bearer ${J.currentUser.token}`},params:{relativePath:e}})},async downloadFile({id:e,name:t}){J.currentUser&&J.currentUser.token&&await X.api.get("/File/downloadFile",{responseType:"blob",headers:{Authorization:`Bearer ${J.currentUser.token}`},params:{fileId:e}}).then((e=>{const i=new Blob([e.data],{type:e.data.type}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download=t,r.click(),URL.revokeObjectURL(r.href)}))},getFileVersions(e){return new Promise(((t,i)=>{X.api.get("/File/getFileVersions",{headers:{Authorization:`Bearer ${J.currentUser.token}`},params:{fileId:e}}).then((e=>{t(e)}))}))},async selectFileVersion(e){await X.api.post("/File/selectFileVersion",null,{headers:{Authorization:`Bearer ${J.currentUser.token}`},params:{id:e}})},async downloadTickedFiles(e){if(J.currentUser&&J.currentUser.token){var t=i(1470);await X.api.get("/File/downloadSelectedFiles",{responseType:"blob",headers:{Authorization:`Bearer ${J.currentUser.token}`},params:{fileIds:Object.values(e)},paramsSerializer:e=>t.stringify(e)}).then((e=>{const t=new Blob([e.data],{type:e.data.type}),i=document.createElement("a");i.href=URL.createObjectURL(t),i.download="files.zip",i.click(),URL.revokeObjectURL(i.href)}))}}}}),Y={class:"text-center text-black"},ee={class:"text-body2"},te={class:"q-mt-lg text-h5"},ie={class:"text-body2"},re={class:"text-body2"},se={class:"text-body2"};function oe(e,t,i,s,o,a){const l=(0,r.up)("q-icon"),n=(0,r.up)("q-btn"),d=(0,r.up)("q-carousel-slide"),c=(0,r.up)("q-carousel"),u=(0,r.up)("q-dialog");return o.fileVersions?((0,r.wg)(),(0,r.j4)(u,{key:0,modelValue:o.carousel,"onUpdate:modelValue":t[1]||(t[1]=e=>o.carousel=e),onHide:a.onDialogHide},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{"transition-prev":"slide-right","transition-next":"slide-left",swipeable:"",animated:"",modelValue:o.slide,"onUpdate:modelValue":t[0]||(t[0]=e=>o.slide=e),"control-color":"primary","navigation-icon":"fa-solid fa-circle-dot",navigation:"",padding:"",height:"42vh",class:"bg-secondary shadow-1 rounded-borders"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.fileVersions,((e,t)=>((0,r.wg)(),(0,r.j4)(d,{name:t,class:"column no-wrap flex-center",key:t},{default:(0,r.w5)((()=>[(0,r.Wm)(l,{name:e.isDeleted?"fa-solid fa-xmark":"fa-solid fa-check",color:"primary",size:"36px",class:"q-my-md"},null,8,["name"]),(0,r._)("div",Y,[(0,r._)("p",ee,(0,S.zw)(e.isDeleted?"Wersja nieaktualna":"Wersja aktualna"),1),(0,r._)("p",te,(0,S.zw)(e.name),1),(0,r._)("p",ie," To jest wersja numer "+(0,S.zw)(e.fileVersion+1),1),(0,r._)("p",re," Jej rozmiar wynosi "+(0,S.zw)(e.size/1e6)+" MB ",1),(0,r._)("p",se," Utworzona "+(0,S.zw)(new Date(e.createdDate).toLocaleString("pl-PL")),1),(0,r.Wm)(n,{color:"primary","text-color":"secondary",label:"Wybierz",class:"q-my-sm",onClick:t=>a.selectVersion(e.id)},null,8,["onClick"])])])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue","onHide"])):(0,r.kq)("",!0)}var ae=i(499);const le={name:"FileVersionsDialog",props:{isVersionsDialogVisible:{type:Boolean,default:!1},fileId:{type:String,required:!0}},data(){return{carousel:(0,ae.iH)(!1),slide:(0,ae.iH)(0),fileVersions:[]}},watch:{isVersionsDialogVisible(e,t){this.carousel=e,this.getFileVersions(this.fileId).then((e=>{this.fileVersions=e.data}))}},methods:{...(0,b.nv)(K,["getFileVersions","selectFileVersion"]),onDialogHide(){this.$emit("dialog-hide"),this.fileVersions=[]},selectVersion(e){this.selectFileVersion(e).then((()=>{this.$emit("dialog-hide-selected"),this.fileVersions=[]}))}},mounted(){this.getFileVersions(this.fileId).then((e=>{this.fileVersions=e.data}))}};var ne=i(2074),de=i(960),ce=i(1694),ue=i(2857);const me=(0,k.Z)(le,[["render",oe]]),pe=me;_()(le,"components",{QDialog:ne.Z,QCarousel:de.Z,QCarouselSlide:ce.Z,QIcon:ue.Z,QBtn:F.Z});const ye={name:"FileGrid",data(){return{userDirectories:[],selected:null,ticked:[],splitterModel:50,isVersionsDialogVisible:!1}},computed:{getSelectedObject(){return this.selected?this.$refs["directoriesTree"].getNodeByKey(this.selected):null},getUserDirectories(){return this.userDirectories}},methods:{...(0,b.nv)(w.X,["getDirectoriesToSelectList","getUserDriveDataToTreeView","downloadDirectory"]),...(0,b.nv)(K,["getUserFiles","deleteFile","downloadFile","downloadTickedFiles"]),async tryDelete(){await this.deleteFile(this.getSelectedObject.relativePath),this.getUserDriveDataToTreeView().then((e=>{this.userDirectories=e,this.selected=null,this.$q.notify({type:"positive",message:"Plik usunięty pomyślnie!"})}))},async tryDownload(){await this.downloadFile({id:this.getSelectedObject.id,name:this.getSelectedObject.name})},async tryDownloadDirectory(){await this.downloadDirectory({id:this.getSelectedObject.id,name:this.getSelectedObject.name})},onDialogHideSelected(){this.isVersionsDialogVisible=!1,this.selected=null,this.$q.notify({type:"positive",message:"Wersja wybrana pomyślnie!"}),this.getUserDriveDataToTreeView().then((e=>{this.userDirectories=e}))},loadUserDriveData(){this.getUserDriveDataToTreeView().then((e=>{this.userDirectories=e}))},async tryDownloadTickedFiles(){await this.downloadTickedFiles(this.ticked)}},mounted(){this.loadUserDriveData()},components:{FileVersionsDialog:pe}};var he=i(7498),fe=i(1831);const ge=(0,k.Z)(ye,[["render",G],["__scopeId","data-v-e309e670"]]),we=ge;_()(ye,"components",{QBtn:F.Z,QSplitter:he.Z,QTree:fe.Z});const be={name:"DrivePage",data(){return{isAddDirectoryMenuOpen:!1}},components:{MainContainer:d.Z,DirectoryAddForm:z,FilesGrid:we},methods:{getButtonLabel(){return this.isAddDirectoryMenuOpen?"Zamknij":"Nowy folder"},getTextColor(){return this.isAddDirectoryMenuOpen?"secondary":"black"},onDirectoryAddFormClose(){this.isAddDirectoryMenuOpen=!1,this.$refs["filesGrid"].loadUserDriveData()}}};var De=i(9885);const ke=(0,k.Z)(be,[["render",n]]),ve=ke;_()(be,"components",{QPage:De.Z,QSpace:q.Z,QBtn:F.Z})},4654:()=>{}}]);